# 随机算法

## Karger算法

Karger最小割算法是一种随机化算法，用于找到无向图的最小割。

时间复杂度为 $O(n^2)$

它的核心思想是通过不断随机选择边并合并其两端的顶点来缩小图，直到只剩下两个顶点。

### 算法步骤

1. **随机选择一条边**：
   - 从图中随机选择一条边 $e = (u, v)$，其中 \(u\) 和 \(v\) 是这条边的两个端点。

2. **合并这条边**：
   - 合并 $u$ 和 $v$ 这两个顶点，创建一个新的超级节点 \(w\)。
   - 更新图中的边，使所有连接到 $u$ 或 \(v\) 的边现在都连接到 \(w\)。也就是说，所有原本连接到 \(u\) 或 \(v\) 的边的端点都更新为 \(w\)。
   - 保留所有平行边（即如果两节点间有多条边，保留这些边）。
   - 删除所有自环（即连接到自身的边）。

3. **重复步骤1和2**：
   - 重复上述步骤，直到图中只剩下两个节点 \($u_1$\) 和 \($v_1$\)。

4. **返回最小割**：
   - 返回这个割集，即所有在收缩过程中被合并到 $v_1$ 的节点。这个割集将对应于图的一个割。

### 算法分析

Karger最小割算法返回最小割的概率至少为 $\frac{2}{n^2}$ 

#### 证明

首先定义一些符号和概念：

- **全局最小割**：$(A^*, B^*)$ 是图 $G$ 的一个全局最小割。
- **边集**：$F^*$ 是所有从 \($A^*$\) 到 $B^*$ 的边的集合。
- **最小割的大小**：$k = |F^*|$ ，即最小割的边数。
- **收缩后的图**：$G'$ 表示在第 $j$ 次迭代后的图，此时有 $n' = n - j$ 个超级节点。

接下来，假设在迭代过程中，最小割中的边未被收缩：

1. **保持最小割**：
   - **假设**：假设在第 \(j\) 次迭代之前，没有收缩 $F^*$ 中的任何边。
   - **性质**：如果在 $G'$ 中没有收缩 $F^*$ 中的任何边，则 \(G'\) 中的最小割仍然是 k

2. **最小割的值**：
   - **值**：因为 \(G'\) 中的最小割仍然是 \(k\)，并且图 $G'$ 中有 $n'$ 个节点，边的数量 $|E'|$ 必然满足 $|E'| \geq \frac{1}{2} k n'$ 
   - **推导**：因为 $|E'| \geq \frac{1}{2} k n'$ ，可以得到 $\frac{k}{|E'|} \leq \frac{2}{n'}$ 

3. **收缩边的概率**：
   - **概率**：在每次迭代中，收缩 \($F^*$\) 中的一条边的概率至多为 $\frac{2}{n'}$ ，因为 $|E'|$ 中的边数较多，且 $\frac{k}{|E'|} \leq \frac{2}{n'}$ 
   - 事件 $E_j$：定义 $E_j$ 为在第 \(j\) 次迭代中未收缩 \($F^*$\) 中的任何边的事件。

#### 计算事件的概率

我们需要计算从初始状态到最后两个节点时，始终不收缩 $F^*$ 中任何边的概率。这相当于计算从迭代开始到结束，每一步都不收缩 $F^*$ 中的边的联合概率。

#### 联合概率

1. **初始概率**：
   - 初始时，图中有 $n$ 个节点。
   - 第一次迭代中，不收缩 $F^*$ 中边的概率为 $1 - \frac{k}{|E|} \geq 1 - \frac{2}{n}$ 

2. **后续概率**：
   - 假设到第 \(j\) 次迭代时，图中有 $n' = n - j$ 个节点。
   - 第 \(j\) 次迭代中，不收缩 \($F^*$\) 中边的概率为 $1 - \frac{k}{|E'|} \geq 1 - \frac{2}{n'}$ 

3. **总概率**：
   - 因此，始终不收缩 $F^*$ 中边的概率为这些事件的联合概率的乘积：
   $\prod_{j=0}^{n-3} \left(1 - \frac{2}{n - j}\right)$
   
   将每一步的不收缩概率连乘起来，我们得到：
   $\prod_{j=0}^{n-3} \left(1 - \frac{2}{n - j}\right) = \prod_{i=2}^{n-1} \left(1 - \frac{2}{i}\right)$
   
4. **估算总概率**：
   
   - 用近似的方法，可以估算出：
   $\prod_{i=2}^{n-1} \left(1 - \frac{2}{i}\right) \approx \frac{2}{n(n-1)}$
   
   因此，算法返回一个最小割的概率至少为 $\frac{2}{n^2}$

