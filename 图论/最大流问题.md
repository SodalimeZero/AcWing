## 最大流

令 $G=(V,E)$ 是一个有源汇点的网络，我们希望在 $G$ 上指定合适的流 $f$，以最大化整个网络的流量 $|f|$（即 $\sum_{x \in V} f(s, x) - \sum_{x \in V} f(x, s)$），这一问题被称作最大流问题（Maximum flow problem）。

### Ford–Fulkerson 增广

该方法使用了**贪心算法** 

#### 算法步骤

1. **初始化**：

   对于每条边 $e \in E$ ，初始流量 $f(e) = 0$

2. **寻找增广路径**：

   在残余网络 $G_f$ 中，找到一条从源点 s 到汇点 t 的增广路径 P

3. **沿增广路径增加流量**：

   - 计算路径 P 的瓶颈容量（即路径上所有边的最小剩余容量）。

   - 沿增广路径 P 增加瓶颈容量的流量，同时更新反向边的流量。

4. **重复**：

   重复步骤2和3，直到在残余网络中找不到从源点 s 到汇点 t 的增广路径为止。

#### 伪代码

```
FOREACH edge e ∈ E : f (e) ← 0.
Gf ← residual network of G with respect to flow f.
WHILE (there exists an s↝t path P in Gf )
	f ← AUGMENT(f, c, P).
	Update Gf.
RETURN f.
```

### 最大流-最小割定理

最大流的值等于最小割的容量。

**增广路径定理**：当且仅当不存在增广路径时，流 \( f \) 是最大流。

### 证明

任意流 $f$ 满足以下三个条件，且这三个条件相互等价：

1. **存在一个割 $(A, B)$，使得割的容量等于流的值**：
   
    $\text{cap}(A, B) = \text{val}(f)$ 
   
2. **流 $f$ 是最大流**：
    $f \text{ 是最大流}$ 

3. **不存在增广路径**：
   相对于 $f$ ，不存在增广路径

### 增广路径的选择

#### 1. Capacity-scaling算法

```
FOREACH edge e ∈ E : f (e) ← 0.
Δ ← largest power of 2 ≤ C.

WHILE (Δ ≥ 1)
	Gf (Δ) ← Δ-residual network of G with respect to flow f .
	WHILE (there exists an s↝t path P in Gf (Δ))
		f ← AUGMENT(f, c, P).
		Update Gf (Δ).
	Δ ← Δ / 2. 
RETURN f.
```

时间复杂度： $ O(m^2\log C) $

#### 2. 最短增广路径

##### 层次图

在有向图 $G=(V, E)$ 中，源点为 s，其层次图（level graph）是一种特殊的子图，它根据从源点 s 到图中其他顶点的最短路径的边数来定义。

<img src="../images/level graph.png" style="zoom:30%;margin-left: 0" />

#### 3. Dinitz算法

