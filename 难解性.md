# Intractability

## 概念

### 归约

设计一个函数 $f(x)$ ，把问题 $X$ 的输入转换成问题 $Y$ 的一个输入，这样就能用问题 $Y$ 的解法来求解。（输出真或假）

### 多项式时间归约（Poly-time reductions）

如果问题 $X$ 可以在多项式时间内（即运行时间与输入大小的多项式成正比）转换为问题 $Y$ ，并且问题 $Y$ 也能在多项式时间内解决，则称问题 $X$ 可以多项式时间归约到问题 $Y$ ，记作 $X \le _PY$

## 实例

### 独立集问题&顶点覆盖问题

1. **独立集问题（INDEPENDENT-SET）**：
   
   给定一个图 $G = (V, E)$  和一个整数 $k$ ，独立集问题是寻找图中的一个顶点子集，这个子集中包含  $k$ 个或更多的顶点，且这些顶点之间没有边相连（即它们是相互独立的）。
   
2. **顶点覆盖问题（VERTEX-COVER）**：
   
   给定一个图 $G = (V, E)$  和一个整数 $k$ ，顶点覆盖问题是寻找图中的一个顶点子集，这个子集包含不超过 $k$ 个顶点，且图中的每条边至少连接到这个子集中的一个顶点。

**定理**：$INDEPENDENT-SET = VERTEX-COVER$

**证明**：

我们证明如果集合 $S$ 是一个大小为 $k$ 的独立集，那么 $V - S$（即顶点集合V中不在S中的顶点集合）是一个大小为 $n - k$ 的顶点覆盖，反之亦然。

**⇒（正向证明）**：

  1. 假设S是任意大小为k的独立集。
  2. $V - S$ 的大小是 $n - k$ 
  3. 考虑任意一条边 $(u, v)\in E$（E是图中的边集）。
  4. 由于S是独立的，这意味着u和v不能同时属于 $S$（即要么u不在S中，要么v不在S中，或者两者都不在）。
  5. 因此，u或v或者两者都在V - S中。
  6. 这意味着V - S覆盖了边 $(u, v)$

**⇐（反向证明）**：
  1. 假设V - S是任意大小为n - k的顶点覆盖。
  2. S的大小是k
  3. 考虑任意一条边 $(u, v)\in E$
  4. 由于V - S是一个顶点覆盖，这意味着u和v不能同时在 $V - S$ 中（即要么u在V - S中，要么v在V - S中，或者两者都不在）。
  5. 因此，u或v或者两者都不在S中。
  6. 这意味着S是一个独立集。

### 顶点覆盖&集合覆盖

#### 证明顶点覆盖问题为 NP 问题

为了证明其 NP 完全，我们首先还是证明其是 NP 问题。

给定一个图 $G$ 和一个顶点集合 $V$ ，我们只需要遍历图中的每一个边，检查其是否与顶点集合$V$中一个点相连，即可判定$V$的正确性。

显然这个过程是可以在多项式时间内完成了，所以顶点覆盖问题是一个 NP 问题。

**引理：** $G=(V,E)$ 包含一个大小为 $k$ 的顶点覆盖当且仅当 $(U,S,k)$ 包含一个大小为 $k$ 的集合覆盖。

**如何从顶点集构建出图？**

- 对于集合覆盖问题中的每一个元素 $u \in U$ ，如果 $u$ 同时在子集 $S_i$ 和子集 $S_j$ 中出现，则在顶点 $v_i$ 和顶点 $v_j$ 之间创建一条边。

- 之后就是找到一个最小的顶点覆盖，覆盖所有的边。

### 3SAT&独立集

<img src="/Users/xblock/Library/Application Support/typora-user-images/image-20240623140453642.png" alt="image-20240623140453642" style="zoom: 33%; margin-left: 0" />

**1. 若已知一个 3-SAT 问题有解，则其转换后的图在顶点覆盖问题上也有解。**

因为我们有一个 3-SAT 有解，那么对于这个 3-SAT 中每一个簇都至少有一个变量为真。

我们取除这个变量外的另外两个变量为顶点覆盖问题中 $V$ 的成员，最后一共可以得到 $2n$ 个成员。

由于对于每一簇而言，转换后在图中构成了一个三角形，所以从三角形的 3 个顶点中选出两个顶点必然会包含该三角形所有的边。

另一方面，对于每一个变量，其都有与其矛盾的不在一个簇的相同变量相连了。

所以只要 3-SAT 问题有解，则对于每一个变量，不管其取值如何，都必然与与其**相矛盾**的相同变量连接（例如不管 $x$ 取真还是取假，都会与 $\bar{x} $ 相连）。

所以 $G$ 在 $k=2n$ 一定满足，只要对应的 3-SAT 问题满足。

**2. 若已知一个顶点覆盖问题 ，其转换后的 3-SAT 也有解。** 

我们可以将 $<G,k>$ 通过上述规则逆向转换为布尔表达式，且将 $G$ 中不属于 $V$ 的顶点所对应的变量取真，则 3-SAT 问题为真。

3-SAT $\le_P$ INDEPENDENT-SET $\le_P$ VERTEX-COVER $\le_P$ SET-COVER.

### 证明VERTEX-COVER $\equiv _P$ FIND-VERTEX-COVER

1. 判别问题是搜索问题的一个特例
2. 当存在一个顶点覆盖的解 $<G,k>$ 时
   - 选择一个顶点 $v$，使得 $G - \{v\}$ 具有一个大小不超过 $k-1$ 的顶点覆盖集。
   - 将这个顶点 $v$ 包含在顶点覆盖集中。
   - 递归地在图 $G - \{v\}$ 中寻找一个大小不超过 $k-1$ 的顶点覆盖集。

### 证明FIND-VERTEX-COVER $\equiv _P$FIND-MIN-VERTEX-COVER 

我们可以通过二分搜索（或线性搜索）来确定最小顶点覆盖集的大小 $k^*$ ：

1. 设定初始的搜索范围为 $[0,|V|]$ ，其中 $|V|$ 是图中顶点的数量。

2. 使用 FIND-VERTEX-COVER 来检查是否存在一个大小不超过 $k$ 的顶点覆盖集。

   如果存在，说明可能存在更小的顶点覆盖集；否则，说明当前的 $k$ 太小。

3. 通过调整搜索范围（在二分搜索中不断缩小范围）来找到最小的 $k$ 值 $k^*$

4. 一旦找到 $k^*$ ，我们就可以使用 FIND-VERTEX-COVER 找到这个大小为 $k^*$ 的顶点覆盖集。

### 证明DIRECTED-HAMILTON-CYCLE $\le _P$ HAMILTON-CYCLE.

图 $G$ 有一条有向哈密顿回路当且仅当它的无向版本 $G'$ 有一条哈密顿回路。

#### 证明过程（⇒ 方向）
1. **假设**：图 $G$ 有一条有向哈密顿回路。这意味着在 $G$ 中存在一条回路，它按顺序访问了每一个顶点恰好一次，并返回到起始顶点，同时遵循了边的方向。

2. **构造 $G'$ **：$G'$ 是 $G$ 的无向版本。这意味着 $G$ 中的每条有向边在 $G'$ 中变成了无向边，因此 $G'$ 的边数是 $G$ 的两倍。

3. **结论**：$G'$ 有一条无向哈密顿回路。由于 $\Gamma$ 是 $G$ 中的一条哈密顿回路，我们可以忽略边的方向将其转换为 $G'$ 中的无向回路。这将产生一条在 $G'$ 中访问每个顶点恰好一次的回路，即哈密顿回路。

#### 证明过程（⇐ 方向）
1. **假设**：图 $G'$ 有一条无向哈密顿回路 $\Gamma'$。这意味着在 $G'$ 中存在一条回路，它访问了每一个顶点恰好一次。
2. **分析**：由于 $G'$ 是从 $G$ 派生出来的，通过忽略边的方向，$\Gamma'$ 可以在 $G$ 中以两种可能的方式进行遍历，这取决于 $G$ 中边的原始方向：遵循 $G$ 中边的原始方向，或者对 $G$ 中边的某些或全部方向进行反转。
3. **两种可能的遍历顺序**：$\Gamma'$ 中的顶点可以按照两种不同的顺序进行访问，这些顺序对应于在 $G$ 中遍历回路的两种方式。
4. **结论**：$\Gamma'$ 中的黑色顶点可以构成 $G$ 中的一条有向哈密顿回路 $\Gamma$ ，或者其反转，取决于选择的遍历顺序。这是因为 $G'$ 中的每条无向边允许 $G$ 中的两种可能方向，通过选择适当的方向，我们可以在 $G$ 中构造一条有向哈密顿回路。

## 适定性（Satisfiability）问题

### 定义

#### SAT 问题

是否存在一个布尔变量赋值使得一个 CNF 公式所有子句都为真

#### MAX-SAT 问题

如何找到一个布尔变量赋值，使得公式中尽可能多的子句为真

- 输入：一个 CNF 公式 $\Phi$ ，由若干子句的合取（与）组成，每个子句由文字的析取（或）组成。

#### 3-SAT 问题

- 输入：一个由若干子句构成的 CNF 公式，其中每个子句包含恰好 3 个文字（布尔变量或其否定）。

### 举例（MAX-SAT）

假设我们有一个 CNF 公式：
$\Phi = (x_1 \lor \neg x_2) \land (\neg x_1 \lor x_3) \land (x_2 \lor \neg x_3) \land (x_1 \lor x_2 \lor x_3)$

我们希望找到一个赋值，使得尽可能多的子句为真。

这里的一种可能的赋值是：$x_1 = \text{true}, x_2 = \text{false}, x_3 = \text{true}$

在这种赋值下，公式中的 4 个子句中有 3 个为真：
1.  $(x_1 \lor \neg x_2)$  为真，因为 $x_1$ 为真。
2. $(\neg x_1 \lor x_3)$ 为真，因为 $x_3$ 为真。
3. $(x_2 \lor \neg x_3)$ 为假，因为 $x_2$ 和 $\neg x_3$ 都为假。
4. $(x_1 \lor x_2 \lor x_3)$ 为真，因为 $x_1$ 和 $x_3$ 都为真。



**科学假设**：目前广泛接受的科学假设是没有多项式时间算法可以解决 3-SAT 问题，即 3-SAT 是一个 NP-complete 问题。

**P vs. NP 问题**：这是计算机科学中的一个著名开放问题。它涉及以下两个类问题：

- **P** 类：可以在多项式时间内解决的问题。
- **NP** 类：可以在多项式时间内验证一个给定解的问题。

**假设**：P ≠ NP 是一个广泛接受但尚未被证明的假设。它断言对于许多 NP 问题，包括 3-SAT，无法在多项式时间内找到解。



## 树的最大独立集问题

### 定义

独立集：图中两两不相邻顶点构成的集合

最大独立集：不是任何其他独立集子集的独立集 

NP难问题，但对于某些特殊的图，存在多项式时间的算法 

目标：计算树的最大独立集

### 解决步骤

以 OPT(u) 表示以 $u$ 为根节点的树的最大独立集的大小 

不在该最大独立集中 • 以 的孩子为根节点的最大独立集的并集 M

**定义动态规划状态**：

- $\text{OPTin}(u)$：表示包含节点 $u$ 的以 $u$ 为根的子树中的最大权重独立集的权重和。
- $\text{OPTout}(u)$：表示不包含节点 $u$ 的以 $u$ 为根的子树中的最大权重独立集的权重和。

**目标**：在根节点 $r$ 处找到最大的独立集权重，即 $\max \{ \text{OPTin}(r), \text{OPTout}(r) \}$

**状态转移：**

- 独立集中包含节点 $u$，那么其权重和等于节点 $u$ 的权重 $w_u$ 加上所有子节点 $v$ 的不包含 $v$ 的最大独立集的权重和。

  $\text{OPTin}(u)=w_u+\sum_{v\in children(u)}^{} \text{OPTout}(v)$

- 独立集中不包含节点 $u$，那么其权重和等于所有子节点 $v$ 的包含 $v$ 或不包含 $v$ 的最大权重独立集的权重和中的最大值

  $\text{OPTout}(u)=\sum_{v\in children(u)}^{} \max \{\text{OPTin}(v), \text{OPTout}(v)\}$

动态规划时间复杂度为 $O(n)$

```
WEIGHTED-INDEPENDENT-SET-IN-A-TREE (T) 
Root the tree T at any node r.
S ← ∅.
FOREACH (node u of T in postorder/topological order) // 确保一个节点被处理时，其子节点都已被处理完
	IF (u is a leaf node)
		Min[u] = wu.
		Mout[u] = 0.
	ELSE
		Min[u] = wu + Σv ∈ children(u) Mout[v].
		Mout[u] = Σv ∈ children(u) max { Min[v], Mout[v] }.
RETURN max { Min[r], Mout[r] }.
```

### 平面图三染色问题

#### 定义

如果图 $G$ 能画在平面 $S$ 上，即除顶点处外无边相交，则称 $G$ 可平面嵌入 $S$ ，$G$ 为可平面图或平面图。

画出的没有边相交的图称为 $G$ 的平面表示或平面嵌入。

#### 引理
引理说明了一个特殊的平面图 $W$ 的性质：

1. 在 $W$ 的任何三染色中，相对的角必须具有相同的颜色。
2. 如果给 $W$ 的角分配颜色且相对的角具有相同的颜色，那么这个颜色分配可以扩展到 $W$ 的一个三染色。

#### 构造方法
为了证明平面三染色性是 NP 完全的，采用以下步骤：

1. **给定实例 $G$ 的 3-染色问题**：这是一个一般的 3-染色问题，其中图 G 可能不是平面图。

2. **将 $G$ 绘制在平面上**：在平面上绘制 $G$ 的过程中，可能会有边相交。

3. **构造平面图  $G'$ **：对于每个边相交点，用引理中的平面 gadget \( W \) 替换这些相交点，以确保得到的图 \( G' \) 是平面图。

#### 证明
为了证明 $G$ 是 3-可染色的当且仅当 \( G' \) 是 3-可染色的，考虑以下两个方向：

1. **$G$  是 3-可染色的 $\Rightarrow$ $G'$ 是 3-可染色的**：
   - 如果 \( G \) 是 3-可染色的，那么我们可以找到一个 3-染色使得 \( G \) 中的所有边两端的顶点颜色不同。
   - 在 \( G' \) 中，每个替换相交点的 \( W \) 保持相对角颜色相同。因此，\( G \) 的 3-染色可以扩展到 \( G' \) 的 3-染色。

2. **\( G' \) 是 3-可染色的 $\Leftarrow$ $G$  是 3-可染色的**：
   - 如果 \( G' \) 是 3-可染色的，那么 \( G' \) 中每个 \( W \) gadget 的相对角有相同的颜色。
   - 因此，可以回到原始图 \( G \) 并且仍然保持 3-染色性质。

#### 详细解释引理的作用
- 在 $W$ 的任何 3-染色中，$a \neq a'$ 且 $b \neq b$' （这里 \( a \) 和 \( a' \) 是相对的角，\( b \) 和 \( b' \) 是另一个相对的角）。
- 如果 $a \neq a'$ 且 $b \neq b'$ ，那么可以扩展到 $W$ 的一个 3-染色，这个 3-染色可以保持 $G$ 的 3-染色性质。

